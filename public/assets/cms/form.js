(function(){$(window).load(function(){return Syntax_Checker.render(),Link_Checker.render(),Form_Alert.addValidation(Form_Alert.clonedName),Form_Alert.addValidation(Form_Alert.validateFilename),Form_Alert.addValidation(Form_Alert.presence),Form_Alert.addValidation(Syntax_Checker.validateHtml),Syntax_Checker.autoCorrect&&Form_Alert.addBeforeSave(Syntax_Checker.correctAll),Form_Alert.render()}),this.Syntax_Checker=function(){function e(){}return e.message={notSetImgAlt:"\u753b\u50cf\u306e\u4ee3\u66ff\u30c6\u30ad\u30b9\u30c8\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",invalidImgScheme:"\u753b\u50cf\u306eURI\u306b\u30d0\u30a4\u30ca\u30ea\u30fc\u6587\u5b57\u5217\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002",notSetTableCaption:"\u8868\u306b\u30ad\u30e3\u30d7\u30b7\u30e7\u30f3\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",notSetThScope:"\u8868\u306e\u30d8\u30c3\u30c0\u30fc\u306b\u30b9\u30b3\u30fc\u30d7\u5c5e\u6027\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",invalidOrderOfH:"\u898b\u51fa\u3057\u306e\u9806\u756a\u304c\u4e0d\u6b63\u3067\u3059\u3002",invalidMultibyteCharacter:"\u82f1\u6570\u5b57\u306f\u534a\u89d2\u6587\u5b57\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",invalidDependentCharacter:"\u6a5f\u7a2e\u4f9d\u5b58\u6587\u5b57\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002",invalidDateFormat:"\u65e5\u4ed8\u306e\u8868\u8a18\u306f\u25cb\u5e74\u25cb\u6708\u25cb\u65e5\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002",invalidAdjacentA:"\u96a3\u63a5\u3059\u308b\u540c\u3058\u30ea\u30f3\u30af\u3092\u4e00\u3064\u306e\u30ea\u30f3\u30af\u306b\u307e\u3068\u3081\u3066\u304f\u3060\u3055\u3044\u3002",checkInterwordSpace:"\u5358\u8a9e\u306e\u6587\u5b57\u9593\u306e\u30b9\u30da\u30fc\u30b9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",checkLinkText:"\u30ea\u30f3\u30af\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002",checkEmbeddedMedia:"\u52d5\u753b\u3084\u97f3\u58f0\u3092\u542b\u3080\u5834\u5408\u3001\u8aac\u660e\u304c\u3042\u308b\u304b\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},e.detail={notSetImgAlt:["\u753b\u50cf\u306e\u5185\u5bb9\u3092\u793a\u3059\u4ee3\u66ff\u30c6\u30ad\u30b9\u30c8\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidImgScheme:["\u753b\u50cf\u306eSRC\u5c5e\u6027\u306b\u30c7\u30fc\u30bf\u5f62\u5f0f\u306eURI\u30b9\u30ad\u30fc\u30e0\u304c\u5b58\u5728\u3057\u307e\u3059\u3002","\u4ed6\u306eURI\u30b9\u30ad\u30fc\u30e0\u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],notSetTableCaption:["\u8868\u306b\u898b\u51fa\u3057(CAPTION)\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093","TABLE\u30bf\u30b0\u306e\u4e2d\u306bCAPTION\u30bf\u30b0\u3092\u8ffd\u8a18\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],notSetThScope:["\u8868\u306e\u30d8\u30c3\u30c0\u30fc(TH)\u306b\u898b\u51fa\u3057\u306e\u65b9\u5411\u3067\u3042\u308bSCOPE\u5c5e\u6027\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002",'\u884c\u65b9\u5411\u3067\u3042\u308c\u3070scope="col\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002','\u5217\u65b9\u5411\u3067\u3042\u308c\u3070scope="row"\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002'],invalidOrderOfH:["\u898b\u51fa\u3057(H)\u306e\u9806\u756a\u304c\u4e0d\u6b63\u3067\u3059\u3002","\u9069\u5207\u306a\u9806\u306b\u914d\u7f6e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidMultibyteCharacter:["\u672c\u6587\u306b\u5168\u89d2\u82f1\u6570\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002","\u534a\u89d2\u82f1\u6570\u306b\u7f6e\u304d\u63db\u3048\u308b\u304b\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidDependentCharacter:["\u672c\u6587\u306b\u6a5f\u7a2e\u4f9d\u5b58\u6587\u5b57\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002","\u4ed6\u306e\u6587\u5b57\u306b\u7f6e\u304d\u63db\u3048\u308b\u304b\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidDateFormat:["\u65e5\u4ed8\u306e\u5f62\u5f0f\u3092\u4fee\u6b63\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],invalidAdjacentA:["\u96a3\u308a\u5408\u3046\u30ea\u30f3\u30af(A)\u306b\u540c\u3058\u30ea\u30f3\u30af\u5148\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u3059\u3002","\u4e00\u3064\u306e\u30ea\u30f3\u30af(A)\u306b\u30de\u30fc\u30af\u30a2\u30c3\u30d7\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],checkInterwordSpace:["\u5358\u8a9e\u306e\u6587\u5b57\u9593\u306b\u4e0d\u8981\u306a\u30b9\u30da\u30fc\u30b9\u304c\u542b\u307e\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u524a\u9664\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],checkLinkText:["\u30ea\u30f3\u30af\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u306f\u9077\u79fb\u5148\u3092\u8868\u3059\u3082\u306e\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"],checkEmbeddedMedia:["\u52d5\u753b\u3084\u97f3\u58f0\u3092\u672c\u6587\u306b\u57cb\u3081\u8fbc\u3080\u5834\u5408\u306f\u8aac\u660e\u3092\u8a18\u8ff0\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]},e.dependentCharacter="\u2460\u2461\u2462\u2463\u2464\u2465\u2466\u2467\u2468\u2469\u246a\u246b\u246c\u246d\u246e\u246f\u2470\u2471\u2472\u2473\u2160\u2161\u2162\u2163\u2164\u2165\u2166\u2167\u2168\u2169\u3349\u3314\u3322\u334d\u3318\u3327\u3303\u3336\u3351\u3357\u330d\u3326\u3323\u332b\u334a\u333b\u339c\u339d\u339e\u338e\u338f\u33c4\u33a1\u337b\u301d\u301f\u2116\u33cd\u2121\u32a4\u32a5\u32a6\u32a7\u32a8\u3231\u3232\u3239\u337e\u337d\u337c\u337b\xa9\xae\u3237\u3230\u322a\u322b\u322c\u322d\u322e\u322f\u3297\u3290\u328a\u328b\u328c\u328d\u328e\u328f\u32c0\u32c1\u32c2\u32c3\u32c4\u32c5\u32c6\u32c7\u32c8\u32c9\u32ca\u32cb\u33e0\u33e1\u33e2\u33e3\u33e4\u33e5\u33e6\u33e7\u33e8\u33e9\u33ea\u33eb\u33ec\u33ed\u33ee\u33ef\u33f0\u33f1\u33f2\u33f3\u33f4\u33f5\u33f6\u33f7\u33f8\u33f9\u33fa\u33fb\u33fc\u33fd\u33fe\u2194\u2195\u2196\u2197\u2198\u2199\u21d2\u21d4\u21d0\u21d1\u21d3\u21d5\u21d6\u21d7\u21d8\u21d9\u32d0\u32d1\u32d2\u32d3\u32d4\u32d5\u32d6\u32d7\u32d8\u32d9\u3291\u3292\u3293\u3294\u3295\u329f\u329a\u329b\u329c\u32a3\u32a1\u32a2\u32ab\u32ac\u32ad\u32ae\u32af\u32b0\u329e\u3296\u32a9\u329d\u3298\u3299\u32aa\u3233\u3234\u3235\u3236\u3238\u323a\u323b\u323c\u323d\u323e\u323f\u25ba\u263a\u25c4\u263b\u203c\u3380\u3381\u3382\u3383\u3384\u3388\u3389\u338a\u338b\u338c\u338d\u3391\u3392\u3393\u2170\u2171\u2172\u2173\u2174\u2175\u2176\u2177\u2178\u2179\u3020\u2660\u2663\u2665\u2664\u2667\u2661\uffe4\uff07",e.mediaExtensions=["aac","aif","aiff","au","avi","flac","flv","mid","midi","mp3","m4a","mp4","mpg","mpeg","oga","ogg","tta","vdo","wav","wma","wmv"],e.errors,e.errorCount,e.autoCorrect=!1,e.reset=function(){this.errors={},this.errorCount=0},e.render=function(){return $(".mod-cms-body button.syntax-check").on("click",function(){return e.check()})},e.check=function(t){var r,a,n;return null==t&&(t={}),e.reset(),r=e.getEditorHtml(),e.checkTable(r),e.checkMultibyteCharacter(r),e.checkDependentCharacter(r),e.checkDateFormat(r),e.checkAdjacentA(r),e.checkOrderOfH(r),e.checkImgAlt(r),e.checkImgDataUriScheme(r),e.checkInterwordSpace(r),e.checkLinkText(r),e.checkEmbeddedMedia(r),$(".mod-cms-body div#errorSyntaxChecker").remove(),a=$("<div>"),a.attr("id","errorSyntaxChecker"),a.attr("class","errorExplanation"),a.append("<h2>\u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af</h2>"),Object.keys(e.errors).length?(a.append("<p>\u6b21\u306e\u9805\u76ee\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p>"),a.append("<ul>"),n=a.find("ul:last"),e.appendMessage(n,e.errors),$(".mod-cms-body dd:last").after(a),SS_Tooltips.render(".detail"),!1):(a.append("<p>\u30a8\u30e9\u30fc\u306f\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002</p>"),$(".mod-cms-body dd:last").after(a),!0)},e.validateHtml=function(){var t,r,a,n,i,c;if(!e.check()){i=e.errors,c=[];for(n in i)r=i[n],c.push(function(){var n,i,c;for(c=[],a=n=0,i=r.length;i>n;a=++n)t=r[a],c.push(t.correct&&e.autoCorrect?Form_Alert.add("\u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af\uff08\u4fdd\u5b58\u6642\u306b\u81ea\u52d5\u3067\u4fee\u6b63\u3055\u308c\u307e\u3059\uff09",this,t.msg):Form_Alert.add("\u30a2\u30af\u30bb\u30b7\u30d3\u30ea\u30c6\u30a3\u30c1\u30a7\u30c3\u30af",this,t.msg));return c}.call(this));return c}},e.correctAll=function(){var t;return t=e.getEditorHtml(),t=e.correctMultibyteCharacter(t),t=e.correctDependentCharacter("<div>"+t+"</div>"),t=e.correctDateFormat("<div>"+t+"</div>"),$("<div>"+t+"</div>").find("table").length&&(t=e.correctTableCaption($("<div>"+t+"</div>").find("table")),t=e.correctTableScope($("<div>"+t+"</div>").find("table"))),$("<div>"+t+"</div>").find("h1,h2,h3,h4,h5,h6").length&&(t=e.correctOrderOfH("<div>"+t+"</div>")),$("<div>"+t+"</div>").find("a[href]").length&&(t=e.correctAdjacentA($("<div>"+t+"</div>").find("a[href]"))),e.setEditorHtml(t)},e.getEditorHtml=function(){var e;return e="undefined"!=typeof tinymce?"<div>"+tinymce.get("item_html").getContent()+"</div>":"undefined"!=typeof CKEDITOR?"<div>"+CKEDITOR.instances.item_html.getData()+"</div>":""},e.setEditorHtml=function(e){return"undefined"!=typeof tinymce?tinymce.get("item_html").setContent(e):"undefined"!=typeof CKEDITOR?CKEDITOR.instances.item_html.setData(e):void 0},e.pushError=function(t){var r;return r=e.errorCount,e.errors[r]=t,e.errorCount+=1,r},e.isValidDate=function(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())&&e.getYear()>0?!0:!1},e.justText=function(e){return $(e).clone().children().remove().end().text()},e.outerHtmlSummary=function(e){return $(e).get(0).outerHTML.replace(/[\r\n]|&nbsp;/g,"")},e.appendMessage=function(t,r){var a,n,i,c,o,d,s,l,h;h=[];for(d in r)c=r[d],t.append('<li class="code">'),t.find("li:last").append("<code>"),t.append("<ul>"),h.push(function(){var r,d,h;for(h=[],o=r=0,d=c.length;d>r;o=++r)i=c[o],t.find("li:last code").text(i.code),t.find("> ul:last").append("<li>"),s=t.find("> ul:last li:last"),l=$('<span class="message detail">'+i.msg+"</span>"),i.detail&&(n=$("<ul>").appendTo(l),$.each(i.detail,function(){return n.append("<li>"+this+"</li>"),n.hide()})),s.append(l),i.correct&&i.ele?(a=$('<a href="#" class="correct">\u81ea\u52d5\u4fee\u6b63</a>'),a.on("click",{error:i},function(t){var r;return r=t.data.error.correct(t.data.error.ele),e.setEditorHtml(r),$(".mod-cms-body button.syntax-check").trigger("click"),!1}),h.push(s.append(a))):h.push(void 0);return h}());return h},e.checkImgAlt=function(t){return $(t).find("img").each(function(){var t,r;return t=$(this).attr("alt"),!t||""===t.trim()||/^[\w\s\.\-]*$/.test(t)?(r=[{code:e.outerHtmlSummary(this),msg:e.message.notSetImgAlt,detail:e.detail.notSetImgAlt,ele:this}],e.pushError(r)):void 0})},e.checkImgDataUriScheme=function(t){return $(t).find("img[src]").each(function(){var t,r;return r=$(this).attr("src"),/^data:.*?,.*?$/.test(r)?(t=[{code:e.outerHtmlSummary(this),msg:e.message.invalidImgScheme,detail:e.detail.invalidImgScheme,ele:this}],e.pushError(t)):void 0})},e.checkTable=function(t){return $(t).find("table").each(function(){var t,r,a;return a=this,t=$(this).find("caption"),r=[],t&&""!==t.text().trim()||r.push({code:e.outerHtmlSummary(a),msg:e.message.notSetTableCaption,detail:e.detail.notSetTableCaption,ele:a,correct:e.correctTableCaption}),$(a).find("th").each(function(){return $(this).attr("scope")?void 0:(r.push({code:e.outerHtmlSummary(a),msg:e.message.notSetThScope,detail:e.detail.notSetThScope,ele:a,correct:e.correctTableScope}),!1)}),$.isEmptyObject(r)?void 0:e.pushError(r)})},e.correctTableCaption=function(e){return $(e).find("caption").remove(),$(e).prepend("<caption>\u30ad\u30e3\u30d7\u30b7\u30e7\u30f3</caption>"),$(e).parents().last().html()||$(e).html()},e.correctTableScope=function(e){var t;return t=1===$(e).find("tr:first th").length?"row":"col",$(e).find("tr:first th").each(function(){return $(this).attr("scope")?void 0:$(this).attr("scope",t)}),$(e).find("tr:not(:first) th").each(function(){return $(this).attr("scope")?void 0:$(this).attr("scope","row")}),$(e).parents().last().html()||$(e).html()},e.checkOrderOfH=function(t){var r,a,n,i,c,o;if(n=$(t).find("h1,h2,h3,h4,h5,h6"),n.length){for(r="",i=c=0,o=n.length-1;o>=0?o>=c:c>=o;i=o>=0?++c:--c)0===i?/h[12]/i.test(n[i].tagName)||(r+=n[i].tagName+" "):/h3/i.test(n[i].tagName)?/h[23456]/i.test(n[i-1].tagName)||(r+=n[i].tagName+" "):/h4/i.test(n[i].tagName)?/h[3456]/i.test(n[i-1].tagName)||(r+=n[i].tagName+" "):/h5/i.test(n[i].tagName)?/h[456]/i.test(n[i-1].tagName)||(r+=n[i].tagName+" "):/h6/i.test(n[i].tagName)&&(/h[56]/i.test(n[i-1].tagName)||(r+=n[i].tagName+" "));""!==r&&(a=[{code:r,msg:e.message.invalidOrderOfH,ele:t,detail:e.detail.invalidOrderOfH,correct:e.correctOrderOfH}],e.pushError(a))}},e.correctOrderOfH=function(e){var t,r,a,n,i;if(t=$(e).find("h1,h2,h3,h4,h5,h6"),!t.length)return $(e).parents().last().html();for(i=e,r=a=0,n=t.length-1;n>=0?n>=a:a>=n;r=n>=0?++a:--a)0===r?/h[12]/i.test(t[r].tagName)||(i=$("<h1>"+$(t[r]).html()+"</h1>"),$(t[r]).after(i).remove(),t[r]=i[0]):/h3/i.test(t[r].tagName)?/h[23456]/i.test(t[r-1].tagName)||(i=$("<"+t[r-1].tagName.replace("1","2")+">"),i.html($(t[r]).html()),$(t[r]).after(i).remove(),t[r]=i[0]):/h4/i.test(t[r].tagName)?/h[3456]/i.test(t[r-1].tagName)||(i=$("<"+t[r-1].tagName.replace("1","2")+">"),i.html($(t[r]).html()),$(t[r]).after(i).remove(),t[r]=i[0]):/h5/i.test(t[r].tagName)?/h[456]/i.test(t[r-1].tagName)||(i=$("<"+t[r-1].tagName.replace("1","2")+">"),i.html($(t[r]).html()),$(t[r]).after(i).remove(),t[r]=i[0]):/h6/i.test(t[r].tagName)&&(/h[56]/i.test(t[r-1].tagName)||(i=$("<"+t[r-1].tagName.replace("1","2")+">"),i.html($(t[r]).html()),$(t[r]).after(i).remove(),t[r]=i[0]));return $(i).parents().last().html()||$(i).html()},e.checkMultibyteCharacter=function(t){var r,a;return r=t.match(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g),$.isEmptyObject(r)?void 0:(a=[{code:r.join(","),msg:e.message.invalidMultibyteCharacter,detail:e.detail.invalidMultibyteCharacter,ele:t,correct:e.correctMultibyteCharacter}],e.pushError(a))},e.correctMultibyteCharacter=function(e){return e=e.replace(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)}),$(e).html()},e.checkDependentCharacter=function(t){var r,a,n;return n=new RegExp("["+e.dependentCharacter+"]","g"),r=t.match(n),$.isEmptyObject(r)?void 0:(a=[{code:r.join(","),msg:e.message.invalidDependentCharacter,detail:e.detail.invalidDependentCharacter,ele:t,correct:e.correctDependentCharacter}],e.pushError(a))},e.correctDependentCharacter=function(t){var r;return r=new RegExp("["+e.dependentCharacter+"]","g"),t=t.replace(r,function(){return"[\u6a5f\u7a2e\u4f9d\u5b58\u6587\u5b57]"}),$(t).html()},e.checkDateFormat=function(t){var r,a;return(r=t.match(/[^\d-]\d{4}[ \\u3000\.\-\/]\d{1,2}[ \\u3000\.\-\/]\d{1,2}[^\d-]/g))?(r=$.map(r,function(e){return e.substr(1,e.length-2)}),r=$.grep(r,function(t){return e.isValidDate(new Date(t))}),$.isEmptyObject(r)?void 0:(a=[{code:r.join(","),msg:e.message.invalidDateFormat,detail:e.detail.invalidDateFormat,ele:t,correct:e.correctDateFormat}],e.pushError(a))):void 0},e.correctDateFormat=function(t){return t=t.replace(/([^\d-])(\d{4})[ \\u3000\.\-\/](\d{1,2})[ \\u3000\.\-\/](\d{1,2})([^\d-])/g,function(t,r,a,n,i,c){return e.isValidDate(new Date([a,n,i].join(" ")))?r+a+"\u5e74"+n+"\u6708"+i+"\u65e5"+c:t}),$(t).html()},e.checkAdjacentA=function(t){return $(t).find("a[href]").each(function(){var t,r;return r=$(this).next('a[href="'+$(this).attr("href")+'"]'),r.length?(t=[{code:e.outerHtmlSummary(this)+e.outerHtmlSummary(r),msg:e.message.invalidAdjacentA,detail:e.detail.invalidAdjacentA,ele:this,correct:e.correctAdjacentA}],e.pushError(t)):void 0})},e.correctAdjacentA=function(e){var t;return t=$(e).next('a[href="'+$(e).attr("href")+'"]'),t.length&&($(e).html()!==$(t).html()&&$(e).html($(e).html()+$(t).html()),t.remove()),$(e).parents().last().html()||$(e).html()},e.checkInterwordSpace=function(t){return $(t).find(":not(iframe)").each(function(){var t,r,a,n,i,c;if(c=$.trim(e.justText(this)),/[\u3000]/.test(c)){for(i=[],r=a=0,n=c.length-1;n>=0?n>=a:a>=n;r=n>=0?++a:--a){if(c.charCodeAt(r)>=256){t=[{code:c,msg:e.message.checkInterwordSpace,detail:e.detail.checkInterwordSpace}],e.pushError(t);break}i.push(void 0)}return i}})},e.checkLinkText=function(t){return $(t).find("a[href]").each(function(){var t,r;return r=$(this).text(),r.length<=3?(t=[{code:e.outerHtmlSummary(this),msg:e.message.checkLinkText,detail:e.detail.checkLinkText}],e.pushError(t)):void 0})},e.checkEmbeddedMedia=function(t){var r,a;return $(t).find("embed,video").each(function(){var t;return t=[{code:this,msg:e.message.checkEmbeddedMedia,detail:e.detail.checkEmbeddedMedia}],e.pushError(t)}),r=new RegExp("("+e.mediaExtensions.join("|")+")","i"),a=/https?:\/\/www\.youtube\.com\//,$(t).find("iframe[src]").each(function(){var t,n,i;return i=$(this).attr("src"),n=i.replace(/\?.*$/,"").replace(/.*\//,"").split(".").pop(),r.test(n)||a.test(i)?(t=[{code:e.outerHtmlSummary(this),msg:e.message.checkEmbeddedMedia,detail:e.detail.checkEmbeddedMedia}],e.pushError(t)):void 0}),$(t).find("a[href]").each(function(){var t,n,i;return i=$(this).attr("href"),n=i.replace(/\?.*$/,"").replace(/.*\//,"").split(".").pop(),r.test(n)||a.test(i)?(t=[{code:e.outerHtmlSummary(this),msg:e.message.checkEmbeddedMedia,detail:e.detail.checkEmbeddedMedia}],e.pushError(t)):void 0})},e}(),this.Link_Checker=function(){function e(){}return e.message={header:"\u30ea\u30f3\u30af\u30c1\u30a7\u30c3\u30af",noLinks:"\u30ea\u30f3\u30af\u306f\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002",checkLinks:"\u6b21\u306e\u30ea\u30f3\u30af\u3092\u78ba\u8a8d\u3057\u307e\u3057\u305f\u3002",success:"\u6210\u529f",failure:"\u5931\u6557",linkCheckerError:"\u30ea\u30f3\u30af\u30c1\u30a7\u30c3\u30af\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u6b21\u306eURL\u306b\u63a5\u7d9a\u3067\u304d\u307e\u305b\u3093\u3002"},e.links={},e.error="",e.url="/.cms/link_check/check.json",e.rootUrl="",e.render=function(){return $(".mod-cms-body button.link-check").on("click",function(){var t,r;$.support.cors=!0,t=this,$(t).attr("disabled",!0),e.reset(),r="undefined"!=typeof tinymce?"<div>"+tinymce.get("item_html").getContent()+"</div>":"undefined"!=typeof CKEDITOR?"<div>"+CKEDITOR.instances.item_html.getData()+"</div>":"<div></div>",e.check(r,function(){var r,a,n,i,c;if(i=$("<div>"),i.attr("id","errorLinkChecker"),i.attr("class","errorExplanation"),i.append("<h2>"+e.message.header+"</h2>"),""!==e.error)i.append(e.error);else{i.append("<p>"+e.message.checkLinks+"</p>"),i.append("<ul>"),c=i.find("ul"),n=e.links;for(r in n)a=n[r],c.append("<li>"),c.find("li:last").append(a)}$(".mod-cms-body div#errorLinkChecker").remove(),$(".mod-cms-body").append(i),$(t).removeAttr("disabled")})})},e.reset=function(){this.links={},this.error=""},e.addMessage=function(t,r){var a;return r?(a='<span class="success">'+e.message.success+"</span>",e.links[t]=t+" "+a):(a='<span class="failure">'+e.message.failure+"</span>",e.links[t]=t+" "+a)},e.check=function(t,r){var a,n,i,c,o,d,s,l;if(s=$(t).find("a[href]").length,0===s)return e.error="<p>"+e.message.noLinks+"</p>",void r();for(d={},l=$(t).find("a[href]"),n=i=0,c=l.length;c>i;n=++i)a=l[n],o=$(a).attr("href"),"#"!==o&&("#"===o[0]?e.addMessage(o,0!==$(t).find(o).length):(/^\//.test(o)&&(o=e.rootUrl+o.slice(1)),d[n+1]=o));$.ajax({type:"POST",url:e.url,cache:!1,data:JSON.stringify({url:d}),contentType:"application/json",dataType:"json",crossDomain:!0,success:function(t){var r;for(o in t)r=t[o],e.addMessage(o,200===r)},error:function(){e.error="<p>"+e.message.linkCheckerError+": "+e.url+"</p>"},complete:function(){r()}})},e}(),this.Form_Alert=function(){function e(){}return e.alerts=[],e.validations=[],e.beforeSaves=[],e.render=function(){return $("input:submit").on("click.form_alert",function(){var t,r,a,n,i,c,o,d,s,l,h,u;if(h=this,c=$(h).closest("form"),!e.validate(c,h)){r=$('<div id="alertExplanation" class="errorExplanation">'),r.append("<h2>\u8b66\u544a</h2>"),l=e.alerts;for(t in l)for(n=l[t],r.append("<p>"+t+"</p>"),u=$("<ul>").appendTo(r),o=d=0,s=n.length;s>d;o=++d)a=n[o],u.append("<li>"+a.msg+"</li>");return i=$('<footer class="send">'),i.append('<button name="button" type="button" class="save">\u8b66\u544a\u3092\u7121\u8996\u3059\u308b</button>'),i.append('<button name="button" type="button" class="cancel">\u30ad\u30e3\u30f3\u30bb\u30eb</button>'),$.colorbox({html:r.get(0).outerHTML+i.get(0).outerHTML,maxHeight:"80%",fixed:!0}),$("#cboxLoadedContent").find(".save").on("click",{submit:h},function(){return e.runBeforeSave(c,h),$(h).off(".form_alert"),$(h).trigger("click")}),$("#cboxLoadedContent").find(".cancel").on("click",function(){return $.colorbox.close(),!1}),!1}})},e.validate=function(t,r){return e.alerts={},$.each(e.validations,function(){return this(t,r)}),$.isEmptyObject(e.alerts)?ture:!1},e.addValidation=function(t){return e.validations.push(t)},e.runBeforeSave=function(t,r){return $.each(e.beforeSaves,function(){return this(t,r)})},e.addBeforeSave=function(t){return e.beforeSaves.push(t)},e.presence=function(t){return $(t).find("input.presence,textarea.presence").each(function(){var t,r;return""===$(this).val()?($(this).closest("dl").show(),t=$(this).closest(".addon-view").find("header").text(),r=e.justText($(this).closest("dd").prev("dt")),e.add(t,this,r+"\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):void 0})},e.clonedName=function(t,r){var a,n,i;return i=$(t).find("#addon-basic #item_name"),$(r).hasClass("publish_save")&&/^\[\u8907\u88fd\]/.test($(i).val())?(a=$(i).closest(".addon-view").find("header").text(),n=e.justText($(i).closest("dd").prev("dt")),e.add(a,i,"\u30bf\u30a4\u30c8\u30eb\u306b[\u8907\u88fd]\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002")):void 0},e.validateFilename=function(t){var r,a,n;return n=$(t).find("#addon-basic .filename"),n.hasClass("cloned")&&/copy\-[a-z0-9]+(\.html)?/.test($(n).val())?(r=$(n).closest(".addon-view").find("header").text(),a=e.justText($(n).closest("dd").prev("dt")),e.add(r,n,"\u30d5\u30a1\u30a4\u30eb\u540d\u306b\u8907\u88fd\u5f8c\u72b6\u614b\uff08copy-\uff09\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002")):void 0},e.add=function(t,r,a){var n;return(n=e.alerts)[t]||(n[t]=[]),e.alerts[t].push({ele:r,msg:a})},e.justText=function(e){return $(e).clone().children().remove().end().text()},e}()}).call(this);
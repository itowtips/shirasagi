(function(){this.Map_Form=function(){function a(){}return a.maxPointForm=10,a.deleteMessage="\u30de\u30fc\u30ab\u30fc\u3092\u524a\u9664\u3057\u3066\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",a.dataID=0,a.clickIcon="http://maps.google.com/mapfiles/ms/icons/blue-dot.png",a.clickMarker=null,a.setMapLoc=function(a,t,e){t=Math.ceil(t*Math.pow(10,6))/Math.pow(10,6),e=Math.ceil(e*Math.pow(10,6))/Math.pow(10,6),a.val(t.toFixed(6)+","+e.toFixed(6))},a.getMapLoc=function(a){var t;return t=a.val().split(","),new google.maps.LatLng(parseFloat(t[0]),parseFloat(t[1]))},a.clonePointForm=function(){var t;$(".mod-map dd.marker").length<a.maxPointForm&&(t=$(".mod-map dd.marker:last").clone(!1).insertAfter($(".mod-map dd.marker:last")),t.attr("data-id",a.dataID),a.dataID+=1,t.find("input,textarea").val(""),t.find(".marker-name").val("\u30de\u30fc\u30ab\u30fc\u540d"),t.find(".clear-marker").on("click",function(){return a.clearPointForm(t)}),t.find(".set-marker").on("click",function(){return a.createMarker(t)}))},a.clearPointForm=function(t){$(".mod-map dd.marker").length>1?""!==t.find(".marker-loc").val()?confirm(a.deleteMessage)&&(Map.markers[parseInt(t.attr("data-id"))]&&Map.markers[parseInt(t.attr("data-id"))].setMap(null),t.find("input,textarea").val(""),t.remove()):(Map.markers[parseInt(t.attr("data-id"))]&&Map.markers[parseInt(t.attr("data-id"))].setMap(null),t.remove()):""!==t.find(".marker-loc").val()&&confirm(a.deleteMessage)&&(Map.markers[parseInt(t.attr("data-id"))]&&Map.markers[parseInt(t.attr("data-id"))].setMap(null),t.find("input,textarea").val(""))},a.createMarker=function(t){""!==$(".mod-map .clicked").val()&&(t.find(".marker-loc").val($(".mod-map .clicked").val()),Map.markers[parseInt(t.attr("data-id"))]&&Map.markers[parseInt(t.attr("data-id"))].setMap(null),Map.markers[parseInt(t.attr("data-id"))]=new google.maps.Marker({position:a.getMapLoc(t.find(".marker-loc")),map:Map.map}))},a.setMarkers=function(){var t,e;google.maps.event.addListener(Map.map,"click",function(t){return a.setMapLoc($(".mod-map .clicked"),t.latLng.lat(),t.latLng.lng()),null!==a.clickMarker&&a.clickMarker.setMap(null),a.clickMarker=new google.maps.Marker({position:new google.maps.LatLng(t.latLng.lat(),t.latLng.lng()),icon:a.clickIcon,map:Map.map})}),$(".mod-map .add-marker").on("click",function(){return a.clonePointForm(),!1}),$(".mod-map .clear-marker").on("click",function(){return a.clearPointForm($(this).closest("dd.marker")),!1}),$(".mod-map .set-marker").on("click",function(){return a.createMarker($(this).closest("dd.marker")),!1}),Map.markers=[],t=new google.maps.LatLngBounds,$(".mod-map dd.marker").each(function(){var e;return $(this).attr("data-id",a.dataID),""!==$(this).find(".marker-loc").val()&&(e=a.getMapLoc($(this).find(".marker-loc")),Map.markers[a.dataID]=new google.maps.Marker({position:e,map:Map.map}),t.extend(e)),a.dataID+=1}),Map.markers.length>0&&(e=google.maps.event.addListener(Map.map,"bounds_changed",function(){return this.getZoom()>13&&this.initialZoom===!0&&(this.setZoom(13),this.initialZoom=!1),google.maps.event.removeListener(e)}),Map.map.initialZoom=!0,Map.map.fitBounds(t))},a}()}).call(this);
<%= javascript_include_tag "//maps.googleapis.com/maps/api/js?v=3" %>
<%= jquery do %>
  Map.center = <%= SS.config.cms.map_center.to_json %>;
  Map.zoom = 12;
  Map.setForm(Member_Photo_Form);

  Map.load("#map-canvas");
  Map.renderMarkers();
  Map.renderEvents();
<% end %>

<div class="mod-map">
  <dl class="marker-setting">
    <dt>
      <%= @model.t :map_points %>
      <%= hidden_field_tag :clicked, nil, class: "loc clicked" %>
    </dt>
    <% if @item.map_points.blank? %>
      <dd class="marker">
        <p>
          <%= hidden_field_tag "item[map_points][][loc]", nil, class: "loc marker-loc" %>
          <%#= text_field_tag "item[map_points][][loc]", nil, class: "loc marker-loc" %>
        </p>
      </dd>
    <% end %>
    <% @item.map_points.each do |point| %>
      <dd class="marker">
        <p>
          <%= hidden_field_tag "item[map_points][][loc]", point[:loc].join(","), class: "loc marker-loc" %>
          <%#= text_field_tag "item[map_points][][loc]", point[:loc].join(","), class: "loc marker-loc" %>
        </p>
      </dd>
    <% end %>
    <div id="map-canvas" style="width: 100%; height: 320px"></div>
    <%= button_tag t("map.button.clear_marker"), { type: :button, class: "clear-marker btn" } %>
  </dl>
</div>

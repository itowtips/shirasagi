<%#= render file: "cms/agents/pages/page/index" %>

<!-- Cms::Addon::Body -->

<% if @cur_page.html.present? %>
  <article class="body">
    <%== @cur_page.html %>
  </article>
<% end %>

<!-- Map::Addon::Page -->

<% if @cur_page.map_points.present? %>
  <%= render_map "#map-canvas", markers: @cur_page.map_points, site: @cur_site %>
  <section class="map-page">
    <header>
      <h2><%= t("map.map") %></h2>
    </header>
    <div id="map-canvas" style="width: 100%; height: 400px;"></div>
  </section>
<% end %>

<!-- Cms::Addon::RelatedPage -->

<% if @cur_page.related_pages.present? %>
  <section class="related-pages">
    <header><h2><%= @cur_page.t :related_pages %></h2></header>
    <div class="pages">
      <ul>
        <% @cur_page.related_pages.order_by(@cur_page.related_page_sort_hash).each do |item| %>
          <%= content_tag(:li, class: item.categories.pluck(:filename).map { |c| c.tr('/', '-') }.presence) do %>
            <%= link_to item.name, item.url %>
          <% end %>
        <% end %>
      </ul>
    </div>
  </section>
<% end %>

<% return unless @cur_node.map_enabled? %>

<%= stylesheet_link_tag 'board/map', media: 'all' %>
<%= javascript_include_tag "board/script" %>

<dl class="see mod-board-post-setting">
  <dt><%= @model.t :point %></dt>
  <dd>
    <div id="map-canvas" style="width: 100%; height: 400px;"></div>
  </dd>
</dl>

<%= jquery do %>
  canvas = $("div#map-canvas")[0];

  var opts = { readonly: true };
  opts['center'] = [<%= @cur_node.map_center.lng %>,<%= @cur_node.map_center.lat %>];

  <% if @item.point.present? %>
    opts['center'] = opts['marker'] = [<%= @item.point.loc.lng %>, <%= @item.point.loc.lat %>];
    opts['zoom'] = <%= @item.point.zoom_level %>;
  <% end %>

  var map = new Board_Map(canvas, opts);
<% end %>
